sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/m/MessageBox"],function(e,t,i){"use strict";return e.extend("com.pso.customerattribute.controller.CustomerDetails",{onInit:function(){var e=this.getOwnerComponent().getRouter();e.getRoute("CustomerDetails").attachMatched(function(e){this._loadFragmentPerScope(e.getParameter("arguments").scope)},this);this.oEditFlag=""},onBeforeRendering:function(){let e=this.getOwnerComponent().getModel("oUserScopeJModel").getData();console.log(e);if(e.hasSpecialsDisplayAccess){this.getView().byId("_IDGenButtonDisplaySp").setVisible(true)}},_loadFragmentPerScope:function(e){this.oEditFlag="";this.initializBusyIndicator();let t=this.getOwnerComponent().getModel("oUserScopeJModel").getData();console.log(t);var i=this.getOwnerComponent().getModel("oCustomerAttributesJModel").oData.superior_flag;if(i=="X"){this.getView().byId("_IDButtonCreateRecord").setText("Create Record");this.getView().byId("idpanel").setVisible(true);this.getView().byId("idpanel2").setVisible(false);if(t.hasCustomerCreateAccess){this.getView().byId("_IDButtonCreateRecord").setVisible(true)}this.getView().byId("idDemolished_site_CC").setVisible(false);this.getView().byId("_IDButtonEditRecord").setVisible(false);this.getView().byId("idButtonOpentext").setVisible(false);this.getView().byId("idButtonCreateServiceTicket").setVisible(false);this.getView().byId("_IDGenButtonDisplaySp").setVisible(false)}else if(i==""){this.getView().byId("idpanel").setVisible(false);this.getView().byId("idpanel2").setVisible(true);if(t.hasCustomerCreateAccess){this.getView().byId("idButtonCreateServiceTicket").setVisible(true)}if(t.hasCustomerEditAccess){this.getView().byId("_IDButtonEditRecord").setVisible(true);this.getView().byId("idDemolished_site_CC").setVisible(true)}this.getView().byId("_IDButtonCreateRecord").setVisible(false);this.getView().byId("idButtonOpentext").setVisible(true);this.getCustomerAttribute()}if(t.hasLimitedDisplay){this.getView().byId("idEmerPhone_DC").setVisible(false)}else{this.getView().byId("idEmerPhone_DC").setVisible(true)}},onSpecialsExist:function(e){let t=this.getOwnerComponent().getModel("oUserScopeJModel").getData();console.log(t);if(e){if(t.hasSpecialsDisplayAccess){this.getView().byId("_IDGenButtonDisplaySp").setVisible(true)}}else{if(t.hasSpecialsCreateAccess){}this.getView().byId("_IDGenButtonDisplaySp").setVisible(false)}},initializBusyIndicator:function(){this.oBusyIndicator=0;this.oBusyIndicator=this.oBusyIndicator?this.oBusyIndicator:new sap.m.BusyDialog({text:"",title:""});return this.oBusyIndicator},onEditCustomerAttribute:function(){this.oEditFlag="X";var e=this.getView().getModel("oCustomerAttributesJModel").getData();if(e.dc==="X"){this.getView().byId("idDCPLIND_CC").setSelectedIndex(0)}if(e.pl==="X"){this.getView().byId("idDCPLIND_CC").setSelectedIndex(1)}if(e.na==="X"){this.getView().byId("idDCPLIND_CC").setSelectedIndex(2)}if(e.dc2==="X"){this.getView().byId("idDCPLIND_CC2").setSelectedIndex(0)}if(e.pl2==="X"){this.getView().byId("idDCPLIND_CC2").setSelectedIndex(1)}if(e.na2==="X"){this.getView().byId("idDCPLIND_CC2").setSelectedIndex(2)}if(e.on_site_emerg==="X"){this.getView().byId("idGeneration_CC").setSelectedKey("EMERGENCY")}if(e.on_site_part==="X"){this.getView().byId("idGeneration_CC").setSelectedKey("PARTIAL")}if(e.full_generation==="X"){this.getView().byId("idGeneration_CC").setSelectedKey("FULL GENERATION")}if(e.on_site_nosg==="X"){this.getView().byId("idGeneration_CC").setSelectedKey("NO ON-SITE GENERATION")}let t=this.getOwnerComponent().getModel("oUserScopeJModel").getData();this.getView().byId("_IDButtonCreateRecord").setText("Update Record");this.getView().byId("idpanel").setVisible(true);this.getView().byId("idpanel2").setVisible(false);if(t.hasCustomerCreateAccess){this.getView().byId("_IDButtonCreateRecord").setVisible(true)}this.getView().byId("_IDButtonEditRecord").setVisible(false);this.getView().byId("idButtonCreateServiceTicket").setVisible(false);this.getView().byId("idButtonOpentext").setVisible(false)},onHelpSubstation:function(e){var t=this.getOwnerComponent().getModel("ISUService").sServiceUrl+"/substation_dropdownSet";var i=this.getView().getModel("oSubstationJModel");i.loadData(t,null,false,"GET",false,false,null);var s=new sap.m.SelectDialog({title:"Substation",contentHeight:"50%",titleAlignment:"Center",items:{path:"/d/results",template:new sap.m.StandardListItem({title:"{substation}",description:"",customData:[new sap.ui.core.CustomData({key:"Key",value:"{substation}"})]})},liveChange:function(e){var t=e.getParameter("value");var i=new sap.ui.model.Filter("substation",sap.ui.model.FilterOperator.Contains,t);e.getSource().getBinding("items").filter([i])},confirm:[this._handleSubstationClose,this],cancel:[this._handleSubstationClose,this]});s.setModel(i);s.open()},_handleSubstationClose:function(e){var t=e.getParameter("selectedItem");if(t){this.objSubstation=t.getBindingContext().getObject();this.getView().byId("idSubstation_CC").setValue(t.getTitle());this.getView().byId("idCircuit_CC").setValue()}},onHelpSubstation2:function(e){var t=this.getOwnerComponent().getModel("ISUService").sServiceUrl+"/substation_dropdownSet";var i=this.getView().getModel("oSubstationJModel2");this.oBusyIndicator.open();i.loadData(t,null,false,"GET",false,false,null);this.oBusyIndicator.close();var s=new sap.m.SelectDialog({title:"Substation",contentHeight:"50%",titleAlignment:"Center",items:{path:"/d/results",template:new sap.m.StandardListItem({title:"{substation}",description:"",customData:[new sap.ui.core.CustomData({key:"Key",value:"{substation}"})]})},liveChange:function(e){var t=e.getParameter("value");var i=new sap.ui.model.Filter("substation",sap.ui.model.FilterOperator.Contains,t);e.getSource().getBinding("items").filter([i])},confirm:[this._handleSubstationClose2,this],cancel:[this._handleSubstationClose2,this]});s.setModel(i);s.open()},_handleSubstationClose2:function(e){var t=e.getParameter("selectedItem");if(t){this.objSubstation=t.getBindingContext().getObject();this.getView().byId("idSubstation2_CC2").setValue(t.getTitle());this.getView().byId("idCircuit2_CC").setValue()}},onHelpCircuit:function(e){var t=this.getView().byId("idSubstation_CC").getValue();if(t===""){sap.m.MessageBox.show(this.getView().getModel("i18n").getProperty("text_note_mandatory"),{icon:sap.m.MessageBox.Icon.WARNING,title:this.getView().getModel("i18n").getProperty("error"),actions:[sap.m.MessageBox.Action.OK]});this.getView().byId("idCircuit_CC").setValue();return}this.oDCPLIND=this.getView().byId("idDCPLIND_CC").getSelectedButton().getText();var i=this.getOwnerComponent().getModel("ISUService").sServiceUrl+"/circuit_dropdownSet";var s=this.getView().getModel("oCircuitJModel");this.oBusyIndicator.open();s.loadData(i,null,false,"GET",false,false,null);this.oBusyIndicator.close();var o=new sap.ui.model.Filter("substation",sap.ui.model.FilterOperator.EQ,t);var n=new sap.ui.model.Filter("dc_pl",sap.ui.model.FilterOperator.EQ,this.oDCPLIND);var a=[o,n];var r=new sap.m.SelectDialog({title:"Circuit",contentHeight:"50%",titleAlignment:"Center",items:{path:"/d/results",template:new sap.m.StandardListItem({title:"{circuit}",description:"",customData:[new sap.ui.core.CustomData({key:"Key",value:"{circuit}"})]})},liveChange:function(e){var t=e.getParameter("value");var i=new sap.ui.model.Filter("circuit",sap.ui.model.FilterOperator.Contains,t);e.getSource().getBinding("items").filter([i])},confirm:[this._handleCircuitClose,this],cancel:[this._handleCircuitClose,this]});r.setModel(s);var l=r.getBinding("items");l.filter([a]);r.open()},_handleCircuitClose:function(e){var t=e.getParameter("selectedItem");if(t){this.obj=t.getBindingContext().getObject();this.getView().byId("idCircuit_CC").setValue(t.getTitle())}},onHelpCircuit2:function(e){var t=this.getView().byId("idSubstation2_CC2").getValue();if(t===""){sap.m.MessageBox.show(this.getView().getModel("i18n").getProperty("text_note_mandatory"),{icon:sap.m.MessageBox.Icon.WARNING,title:this.getView().getModel("i18n").getProperty("error"),actions:[sap.m.MessageBox.Action.OK]});this.getView().byId("idCircuit2_CC").setValue();return}this.oDCPLIND2=this.getView().byId("idDCPLIND_CC2").getSelectedButton().getText();var i=this.getOwnerComponent().getModel("ISUService").sServiceUrl+"/circuit_dropdownSet";var s=this.getView().getModel("oCircuitJModel2");this.oBusyIndicator.open();s.loadData(i,null,false,"GET",false,false,null);this.oBusyIndicator.close();var o=new sap.ui.model.Filter("substation",sap.ui.model.FilterOperator.EQ,t);var n=new sap.ui.model.Filter("dc_pl",sap.ui.model.FilterOperator.EQ,this.oDCPLIND2);var a=[o,n];var r=new sap.m.SelectDialog({title:"Circuit",contentHeight:"50%",titleAlignment:"Center",items:{path:"/d/results",template:new sap.m.StandardListItem({title:"{circuit}",description:"",customData:[new sap.ui.core.CustomData({key:"Key",value:"{circuit}"})]})},liveChange:function(e){var t=e.getParameter("value");var i=new sap.ui.model.Filter("circuit",sap.ui.model.FilterOperator.Contains,t);e.getSource().getBinding("items").filter([i])},confirm:[this._handleCircuitClose2,this],cancel:[this._handleCircuitClose2,this]});r.setModel(s);var l=r.getBinding("items");l.filter([a]);r.open()},_handleCircuitClose2:function(e){var t=e.getParameter("selectedItem");if(t){this.obj=t.getBindingContext().getObject();this.getView().byId("idCircuit2_CC").setValue(t.getTitle())}},getCustomerAttribute:function(){var e=this;var t=this.getOwnerComponent().getModel("oCustomerAttributesJModel").oData.conn_obj;this.getDocumentumURL();this.fetchSpecialsRecord(t);var i=this.getOwnerComponent().getModel("oCustomerAttributesJModel");this.getOwnerComponent().getModel("ISUService").read("/Customer_attributeSet(conn_obj='"+t+"')",{success:function(t){i.setData(t);e.DocumentumDisabled(t)},error:function(e){sap.m.MessageBox.show(e.message,{icon:sap.m.MessageBox.Icon.ERROR,title:"Error",actions:[sap.m.MessageBox.Action.OK]});i.setData([])}})},DocumentumDisabled:function(e){var t=this.getOwnerComponent().getModel("oCustomerAttributesJModel").getData();if(t.on_site_emerg==="X"){this.getView().byId("idGeneration_DC").setText("EMERGENCY")}if(t.on_site_part==="X"){this.getView().byId("idGeneration_DC").setText("PARTIAL")}if(t.full_generation==="X"){this.getView().byId("idGeneration_DC").setText("FULL GENERATION")}if(t.on_site_nosg==="X"){this.getView().byId("idGeneration_DC").setText("NO ON-SITE GENERATION")}if(e.circuit_doc_id===""){this.getView().byId("idCircuitDoc_idlink").setEnabled(false)}else{this.getView().byId("idCircuitDoc_idlink").setEnabled(true)}if(e.doc_id===""){this.getView().byId("idpswdocidlink").setEnabled(false)}else{this.getView().byId("idpswdocidlink").setEnabled(true)}if(e.circuit_doc_id2===""){this.getView().byId("idCircuitDoc_idlink2").setEnabled(false)}else{this.getView().byId("idCircuitDoc_idlink2").setEnabled(true)}if(e.doc_id2===""){this.getView().byId("idpswdocidlink2").setEnabled(false)}else{this.getView().byId("idpswdocidlink2").setEnabled(true)}},onDCPLINDSelect:function(){var e=this.oView.byId("idDCPLIND_CC").getSelectedButton();this.oDCPLIND=e.getText();if(this.oDCPLIND==="IND"){this.oView.byId("idTrans_CC").setVisible(true);this.getView().byId("idCircuit_CC").setEnabled(false);this.getView().byId("idCircuit_CC").setValue()}else{this.oView.byId("idTrans_CC").setVisible(false);this.oView.byId("idTrans_CC").setValue();this.getView().byId("idCircuit_CC").setEnabled(true)}},onDCPLINDSelect2:function(){var e=this.oView.byId("idDCPLIND_CC2").getSelectedButton();this.oDCPLIND2=e.getText();if(this.oDCPLIND2==="IND"){this.oView.byId("idTrans_CC2").setVisible(true);this.getView().byId("idCircuit2_CC").setEnabled(false);this.getView().byId("idCircuit2_CC").setValue()}else{this.oView.byId("idTrans_CC2").setVisible(false);this.oView.byId("idTrans_CC2").setValue();this.getView().byId("idCircuit2_CC").setEnabled(true)}},fetchDestinationURL:async function(e,t){var s=this;var o=this.getOwnerComponent().getModel();var n=o.bindContext("/fetchDestinationURL(...)");n.setParameter("destName",e);await n.execute().then(function(i){var o=n.getBoundContext().getObject();console.log(o.value);const a=o.value;if(e==="OpenText"){const e=a+t+"&language=EN";console.log(e);window.open(e,"_blank")}else if(e==="PSO_DocID"){s.PSOdocURL=o.value;console.log(s.PSOdocURL)}}.bind(this),function(e){i.error(e.message)}.bind(this))},getDocumentumURL:async function(){await this.fetchDestinationURL("PSO_DocID");console.log("got url as : "+this.PSOdocURL)},launchOpentextURL:async function(){const e=this.getView().getModel("oCustomerAttributesJModel").getData().conn_obj;await this.fetchDestinationURL("OpenText",e)},createCustomerDetails:function(){var e=this;var t=this.getView().byId("idStreetno_CC").getValue();var i=this.getView().byId("idStreetAdd_CC").getValue();var s=this.getView().byId("idCustomerName_CC").getValue();if(t===""||i===""||s===""){sap.m.MessageBox.show(this.getView().getModel("i18n").getProperty("document_note_mandatory"),{icon:sap.m.MessageBox.Icon.WARNING,title:this.getView().getModel("i18n").getProperty("error"),actions:[sap.m.MessageBox.Action.OK]});return}var o=[];var n=this.getView().getModel("oCustomerAttributesJModel").getData();var a=this.getOwnerComponent().getModel("oUserScopeJModel").getData();var r="";if(a.userName!==""||a.userName!==undefined||a.userName!==null){r=a.userName}var l=this.getView().byId("idDCPLIND_CC").getSelectedIndex();var c="",d="",u="";if(l===0){c="X"}else if(l===1){d="X"}else{u="X"}var g=this.getView().byId("idDCPLIND_CC2").getSelectedIndex();var C="",h="",p="";if(g===0){C="X"}else if(g===1){h="X"}else{p="X"}var m=this.getView().byId("idGeneration_CC").getSelectedKey();var _="",b="",w="",I="";if(m==="EMERGENCY"){_="X"}else if(m==="PARTIAL"){b="X"}else if(m==="FULL GENERATION"){w="X"}else if(m==="NO ON-SITE GENERATION"){I="X"}var f=this.getView().byId("idNoOfline_CC").getSelectedKey();var y=this.getView().byId("idSrvCenter_CC").getSelectedKey();var S=this.getView().byId("idPSR_CC").getSelectedKey();var V=this.getView().byId("idProEqp1_CC").getSelectedKey();var D=this.getView().byId("idProEqp1_CC2").getSelectedKey();var v=this.getView().byId("idProEqp2_CC").getSelectedKey();var B=this.getView().byId("idProEqp2_CC2").getSelectedKey();var M=this.getView().byId("idThrowoverTyp_CC").getSelectedKey();var O=this.getView().byId("idThrowoverTyp2_CC").getSelectedKey();var x=this.getView().byId("idServiceType_CC").getSelectedKey();var T=this.getView().byId("idServiceType2_CC").getSelectedKey();var P=this.getView().byId("idComents_CC").getValue();var E=this.getView().byId("idComents2_CC").getValue();var N=this.getView().byId("idDemolished_site_CC").getSelected();var R="";if(N===true){R="X"}var A={};A.conn_obj=n.conn_obj;A.cust_name=n.cust_name;A.street_no=n.street_no;A.street_name=n.street_name;A.city=n.city;A.zip_code=n.zip_code;A.no_of_lines=f;A.srv_center=y;A.psr=S;A.emer_cont_name=n.emer_cont_name;A.emer_title=n.emer_title;A.emer_phone=n.emer_phone;A.psw=n.psw;A.on_site_emerg=_;A.on_site_part=b;A.on_site_nosg=I;A.full_generation=w;A.generation=n.generation;A.pso_site="";A.demo_site=R;A.dc=c;A.pl=d;A.na=u;A.sub_station=n.sub_station;A.indus_cust=n.indus_cust;A.circuit=n.circuit;A.circuit_doc_id=n.circuit_doc_id;A.sketch_no=n.sketch_no;A.cable_no=n.cable_no;A.throw_type=M;A.prot_equip1=V;A.prot_equip2=v;A.srv_type=x;A.sect_point=n.sect_point;A.doc_id=n.doc_id;A.comments=P;A.dc2=C;A.pl2=h;A.na2=p;A.sub_station2=n.sub_station2;A.indus_cust2=n.indus_cust2;A.circuit2=n.circuit2;A.circuit_doc_id2=n.circuit_doc_id2;A.sketch_no2=n.sketch_no2;A.cable_no2=n.cable_no2;A.throw_type2=O;A.prot_equip1_2=D;A.prot_equip2_2=B;A.srv_type2=T;A.sect_point2=n.sect_point2;A.doc_id2=n.doc_id2;A.comments2=E;if(this.oEditFlag=="X"){A.modified_by=r}else{A.created_by=r}if(this.oEditFlag=="X"){e.oBusyIndicator.open();this.getOwnerComponent().getModel("ISUService").update("/Customer_attributeSet('"+A.conn_obj+"')",A,{method:"PUT",success:function(t,i){e.oBusyIndicator.close();if(i.statusCode==="204"){var s=JSON.parse(i.headers["sap-message"]);var o=new sap.m.Dialog({title:"Success",type:"Message",state:"Success",content:new sap.m.Text({text:s.message}),endButton:new sap.m.Button({text:"OK",press:function(){o.close();window.history.go(-1)}}),afterClose:function(){o.destroy()}});o.open()}else{e.oBusyIndicator.close();sap.m.MessageBox.show(i.statusText,{icon:sap.m.MessageBox.Icon.ERROR,title:this.getView().getModel("i18n").getProperty("error"),actions:[sap.m.MessageBox.Action.OK]})}},error:function(t){e.oBusyIndicator.close();var i=JSON.parse(t.responseText);var s=i.error.message.value;sap.m.MessageBox.show(s,{icon:sap.m.MessageBox.Icon.ERROR,title:"Error",actions:[sap.m.MessageBox.Action.OK]})}})}else{e.oBusyIndicator.open();this.getOwnerComponent().getModel("ISUService").create("/Customer_attributeSet",A,{success:function(t,i){e.oBusyIndicator.close();var s=JSON.parse(i.headers["sap-message"]);if(i.statusCode==="201"){var o=new sap.m.Dialog({title:"Success",type:"Message",state:"Success",content:new sap.m.Text({text:s.message}),endButton:new sap.m.Button({text:"OK",press:function(){o.close();window.history.go(-1)}}),afterClose:function(){o.destroy()}});o.open()}else{e.oBusyIndicator.close();sap.m.MessageBox.show(s.message,{icon:sap.m.MessageBox.Icon.ERROR,title:this.getView().getModel("i18n").getProperty("error"),actions:[sap.m.MessageBox.Action.OK]})}},error:function(t){e.oBusyIndicator.close();var i=JSON.parse(t.responseText);var s=i.error.message.value;sap.m.MessageBox.show(s,{icon:sap.m.MessageBox.Icon.ERROR,title:"Error",actions:[sap.m.MessageBox.Action.OK]})}})}},onBack:function(e){window.history.go(-1)},onCreateSpecials:function(e){var t=sap.ui.core.UIComponent.getRouterFor(this);t.navTo("CustomerSpecials")},onDiplaySpecials:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("CustomerSpecials")},fetchSpecialsRecord:async function(e){var t=this.getOwnerComponent().getModel();var i=this.getOwnerComponent().getModel("oSpecialsjmodel");var s=t.bindContext("/getSpecialsRecord(...)");s.setParameter("connection_object",e);var o=this;await s.execute().then(function(e){var t=s.getBoundContext().getObject();console.log(t);if(t&&t.value){console.log(t.value);i.setData(t.value);o.onSpecialsExist(true)}else{console.log("No Specials exist for this child connection object");const e=o.getOwnerComponent().getModel("oCustomerAttributesJModel").getData();const t=e.conn_obj;i.setData({connection_object:t,work_desc:"",meter_number:"",record_status:"",workflow_id:null,pSNumber:"",completionDate:"",fedFrom:"",cableDescription:"",cableFootage:"",ductType:"",cts:"",pts:"",k:"",m:"",fusesAt:"",size:"",typeCR:"",curve:"",voltage:"",manufacturer:"",model:"",continuousCurrent:"",loadIntRating:"",kAMomentaryLBD:"",typeLBD:"",faultClosing:"",bilLBD:"",serviceVoltage:"",CycWithstand60:"",circuitBreakerMake:"",serialNo:"",kAMomentaryCB:"",amps:"",typeCB:"",faultDuty:"",bilCB:"",ownedByTransformer:"DTE Owned",fuelTypeCB:"Air",ownedByLBD:"DTE Owned",ownedByCB:"DTE Owned",meter_number2:"",ab:"",bc:"",ca:"",an:"",bn:"",cn:"",groundMatResistance:"",methodUsed:"",dateMergered:"",comment:"",typeofService:"",typeofTO:"",pswDiagramNumber:"",primaryServiceRep:"",customerName:e.cust_name,streetNumber:e.street_no,streetName:e.street_name,fuses:[{fuseSize:"",fuseType:"",fuseCurve:"",fuseVoltage:"",fuseSeqNo:0,connection_object:t}]});o.onSpecialsExist(false)}console.log("success: = ")}.bind(this),function(e){console.log("failure: = "+e.message)}.bind(this))},onDemolishedChecked:function(e){var t="";var i=this;var s=this.getView().byId("idDemolished_site_CC").getSelected();if(s===true){t=this.getView().getModel("i18n").getProperty("Demolished_Checked_msg")}else{t=this.getView().getModel("i18n").getProperty("Demolished_UnChecked_msg")}var o=new sap.m.Dialog({title:"Confirmation",type:"Message",state:"Information",titleAlignment:"Center",content:new sap.m.Text({text:t}),beginButton:new sap.m.Button({text:"Yes",press:function(e){if(s===true&&e.getSource().getText()==="Yes"){i.getView().byId("idDemolished_site_CC").setSelected(true)}else{i.getView().byId("idDemolished_site_CC").setSelected(false)}o.close()}}),endButton:new sap.m.Button({text:"No",press:function(e){if(s===true&&e.getSource().getText()==="No"){i.getView().byId("idDemolished_site_CC").setSelected(false)}else{i.getView().byId("idDemolished_site_CC").setSelected(true)}o.close()}}),afterClose:function(){o.destroy()}});o.open()},onPressCircuitDocIdLink:function(){var e=this;var t=this.getView().byId("idCircuitDoc_DC").getText();var i=e.PSOdocURL+t;window.open(i,"_blank")},onPressPswDocId:function(){var e=this;var t=this.getView().byId("idPswdocid_DC").getText();var i=e.PSOdocURL+t;window.open(i,"_blank")},onPressCircuitDocIdLink2:function(){var e=this;var t=this.getView().byId("idCircuitDoc2_DC").getText();var i=e.PSOdocURL+t;window.open(i,"_blank")},onPressPswDocId2:function(){var e=this;var t=this.getView().byId("idPswdocid2_DC").getText();var i=e.PSOdocURL+t;window.open(i,"_blank")},onCreateServiceTicket:function(){if(!this.oSTDialog){this.oSTDialog=this.loadFragment({name:"com.pso.customerattribute.fragment.CreateServiceTicket"})}this.oSTDialog.then(function(e){this.oDialog=e;this.oDialog.open();this.getView().addDependent(this.oDialog)}.bind(this))},onCloseDialog:function(){this.oDialog.close()},getCreateContext:function(){let e=this.getOwnerComponent().getModel("oCustomerAttributesJModel").oData.conn_obj;let t=this.getOwnerComponent().getModel("oCustomerAttributesJModel").getData();let i="POO - "+t.cust_name;let s="",o="",n="";n=t.sub_station;if(this.oSelectedSetA){n=t.sub_station;if(t.dc==="X"){s="101";o=t.circuit}else if(t.pl==="X"){s="111";o=t.circuit}else if(t.na==="X"){s="112";o=t.indus_cust}}else if(this.oSelectedSetB){n=t.sub_station2;if(t.dc2==="X"){s="101";o=t.circuit2}else if(t.pl2==="X"){s="111";o=t.circuit2}else if(t.na2==="X"){s="112";o=t.indus_cust2}}let a={ProcessingTypeCode:"ZUSR",Name:i,ServiceIssueCategoryID:"SC_2",IncidentServiceIssueCategoryID:"IC_5",ProcessorPartyID:this.oUserId,InstallationPointID:e,PartyID:t.c4cpartyid,RoleCode:"10",Z_PSO_DCPLIND_KUT:s,Z_PSO_ServiceCenter_KUT:t.srv_center,Z_PSO_Substation_KUT:n,Z_PSO_Circuit_Trans_KUT:o,Z_PSO_PSCableNo_KUT:t.cable_no,Z_PSO_CustomerName_KUT:t.cust_name};return a},createServiceTicket:async function(e){let t=this.getOwnerComponent().getModel("oCustomerAttributesJModel").getData();this.oSelectedSetA=this.getView().byId("idSetA").getSelected();this.oSelectedSetB=this.getView().byId("idSetB").getSelected();var s="",o="",n="";if(this.oSelectedSetA){n=t.na;s=this.getView().byId("idCircuit_ST").getText();o=this.getView().byId("idTrans_ST").getText()}else if(this.oSelectedSetB){n=t.na2;s=this.getView().byId("idCircuit_ST1").getText();o=this.getView().byId("idTrans_ST1").getText()}if(n==="X"){if(o===""||o===null||o===undefined){sap.m.MessageBox.show(this.getView().getModel("i18n").getProperty("Trans_msg"),{icon:sap.m.MessageBox.Icon.ERROR,title:"Error",actions:[sap.m.MessageBox.Action.OK]});this.onCloseDialog();return false}}else{if(s===""||s===null||s===undefined){sap.m.MessageBox.show(this.getView().getModel("i18n").getProperty("Circuit_msg"),{icon:sap.m.MessageBox.Icon.ERROR,title:"Error",actions:[sap.m.MessageBox.Action.OK]});this.onCloseDialog();return false}}var a=this.getOwnerComponent().getModel("oUserScopeJModel").getData();if(a.userName===""||a.userName===undefined||a.userName===null){sap.m.MessageBox.show(this.getView().getModel("i18n").getProperty("user_auth_msg"),{icon:sap.m.MessageBox.Icon.ERROR,title:"Error",actions:[sap.m.MessageBox.Action.OK]});return false}else{this.oUserId=a.userName}var r=this.getOwnerComponent().getModel();var l=r.bindContext("/createServiceTicket(...)");var c=this.getCreateContext();this.oBusyIndicator.open();l.setParameter("context",c);var d=this;await l.execute().then(function(e){var t=l.getBoundContext().getObject();console.log(t);if(t&&t.value){d.oBusyIndicator.close();console.log(t.value);let e="Service Ticket "+t.value+" created successfully in C4C. \nPlease save this number for future reference.";sap.m.MessageBox.show(e,{icon:sap.m.MessageBox.Icon.INFORMATION,title:"Success",actions:[sap.m.MessageBox.Action.OK],emphasizedAction:i.Action.OK,onClose:function(e){d.onCloseDialog()},dependentOn:d.getView()})}this.onCloseDialog();console.log("success: = ticket created")}.bind(this),function(e){d.oBusyIndicator.close();console.log("failure: = "+e.message);sap.m.MessageBox.show(this.getView().getModel("i18n").getProperty("PO_creation_failed"),{icon:sap.m.MessageBox.Icon.ERROR,title:"Error",actions:[sap.m.MessageBox.Action.OK]});this.onCloseDialog()}.bind(this))},onCapitalizeFirtsLater:function(e){var t=e.getSource();var i=t.getValue();var s=this.capitalizeFirstLetterOfEachWord(i);t.setValue(s)},capitalizeFirstLetterOfEachWord:function(e){return e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")},oSelectA:function(e){this.getView().byId("idSetB").setSelected(false)},oSelectB:function(e){this.getView().byId("idSetA").setSelected(false)}})});
//# sourceMappingURL=CustomerDetails.controller.js.map